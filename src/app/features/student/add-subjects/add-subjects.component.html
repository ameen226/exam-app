<div class="container-fluid py-4">
  <div class="row justify-content-center">
    <div class="col-12 col-xl-8">
      <div class="main-container p-4">
        <h1 class="page-title">Add Subjects</h1>
        
        <!-- Loading State -->
        <div *ngIf="loading" class="text-center my-4">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>

        <!-- Error State -->
        <div *ngIf="error" class="alert alert-danger" role="alert">
          {{ error }}
          <button type="button" class="btn btn-sm btn-outline-danger ms-2" (click)="error = null">
            Dismiss
          </button>
        </div>

        <div *ngIf="!loading">
          <!-- Selected Count -->
          <div class="selected-count">
            <p class="count-text">Selected Subjects: <span>{{ selectedSubjects.length }}</span></p>
          </div>
          
          <!-- Available Subjects -->
          <div class="subjects-section">
            <h3 class="section-title">Available Subjects</h3>
            <div class="subjects-container">
              <div 
                *ngFor="let subject of subjects" 
                class="subject-card"
                [class.selected]="subject.selected"
                [class.enrolled]="subject.enrolled"
                (click)="!subject.enrolled && toggleSubject(subject.id)"
                [style.cursor]="subject.enrolled ? 'not-allowed' : 'pointer'">
                
                <div class="subject-status">
                  <span 
                    class="status-badge"
                    [class.status-available]="!subject.enrolled && !subject.selected"
                    [class.status-selected]="!subject.enrolled && subject.selected"
                    [class.status-enrolled]="subject.enrolled">
                    {{ getStatusText(subject) }}
                  </span>
                </div>
                <h5 class="subject-name">{{ subject.name }}</h5>
              </div>
              
              <!-- Empty State -->
              <div *ngIf="subjects.length === 0 && !loading" class="text-center text-muted py-4">
                <p>No subjects available</p>
              </div>
            </div>
          </div>
          
          <!-- Action Buttons -->
          <div class="text-center">
            <button 
              type="button" 
              class="btn btn-secondary me-3" 
              (click)="clearSelection()"
              [disabled]="selectedSubjects.length === 0 || submitting">
              Clear Selection
            </button>
            <button 
              type="button" 
              class="btn btn-success" 
              (click)="addSelectedSubjects()"
              [disabled]="selectedSubjects.length === 0 || submitting">
              <span *ngIf="submitting" class="spinner-border spinner-border-sm me-2" role="status"></span>
              {{ submitting ? 'Adding...' : 'Add Selected Subjects' }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Success Modal -->
<div 
  class="modal fade" 
  [class.show]="showSuccessModal" 
  [style.display]="showSuccessModal ? 'block' : 'none'"
  tabindex="-1"
  [attr.aria-hidden]="!showSuccessModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Success</h5>
        <button type="button" class="btn-close" (click)="closeSuccessModal()" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>Successfully added {{ lastAddedCount }} subject(s):</p>
        <ul>
          <li *ngFor="let name of lastAddedSubjects">{{ name }}</li>
        </ul>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" (click)="closeSuccessModal()">OK</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Backdrop -->
<div 
  *ngIf="showSuccessModal" 
  class="modal-backdrop fade show"
  (click)="closeSuccessModal()">
</div>